<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="GitLab Pages">
    <meta name="description" content="Fab Academy documentation site for Peter Perez">
    <title>Peter Perez- Fab Academy - Week 08</title>
    <link rel="stylesheet" href="../style.css">
  </head>
  <body>
    <header class="header">
      <h1>Peter Perez's Fab Academy Portfolio</h1>
      <h1>Week 08 - Electronics Design</h1>
      <nav class="top-nav">
          <ul>
              <li><a href="../index.html">Home</a></li>
              <li><a href="../about.html">About Me</a></li>
              <li><a href="https://fabacademy.org/2024/labs/hopelab/">The Moonlighter</a></li>
              <li><a href="../final-project.html">Final Project</a></li>
              <!-- Add other navigation links as needed -->
          </ul>
      </nav>
  </header>
  <div class="week-content text-center">
    <h2>Week 8's Goals:</h2>
    <ul>
      <li>Group Assignment</li>
      <ul>
        <li>Use the test equipment in your lab to observe the operation of a microcontroller circuit board (as a minimum, you should demonstrate the use of a multimeter and oscilloscope)</li>
        <li>Document your work on the group work page and reflect what you learned on your individual page</li>
      </ul>
      <li>Individual Assignment</li>
      <ul>
        <li>Document your work on the group work page and reflect what you learned on your individual page</li>
      </ul>
      <li>Tools Used</li>
      <ul>
        <li>KiCAD</li>
        <li>Fab Academy KiCAD Libraries</li>
        <li>Bantam Tools PCB Mill</li>
        <li>Arduino IDE</li>
        <li>Arduino Servo Library</li>
      </ul>
    </ul>
  </div>

  <div class="week-content text-center">
    <h2>Group Assignments</h2>
    <p>To test out the microcontroller we decided to probe two different types of outputs on the Quentorres board. First was the LED which we coded to turn on and off. We also did a signal to the servo to change to three positions.</p>
    <h3>The LED</h3>
    <p>The LED is a simple system that just turns the code on and off. When you probe it with the Oscilloscope you place one lead on ground. The second lead needs to be where the LED is connected in the case of this board on the top left pin. </p>
    
    <iframe width="560" height="315" src="https://www.youtube.com/embed/iPLkqfVKQkk" title="Multimeter LED" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
    <p>When you look the output it just pops up to 3.3 V and back down to zero like flipping a switch.</p>

    <iframe width="560" height="315" src="https://www.youtube.com/embed/ZdYnclpTJvA" title="Oscilloscope LED" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
    <p>This also reflects with the oscilloscope, that goes up and down just like the multimeter.</p>

    <h3>The Servo</h3>
    <p>When it comes to the servo, microcontollers run this using pulse width modulation. What we coded the circuit to do was push the servo from 0 degrees to 90 to 180 degrees back to zero. You can see what the circuit does is make a big pulse, a smaller pulse, and then a medium sized pulse.</p>
    <iframe width="560" height="315" src="https://www.youtube.com/embed/TgJ984iiGBA" title="Oscilloscope Servo" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
    <p>When you probe it with a multimeter, what shows up is a lowering voltage. This is because what the multimeter does is read the root mean square of the value. So something being on longer averages to a higher value.</p>

    <iframe width="560" height="315" src="https://www.youtube.com/embed/9B0-a223yB0" title="Multimeter Servo" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

    <p>It was very interesting seeing the outputs for the servo be controlled using PWM as I had never probed it before. It is also good knowing that though I am not truly seeing what is happening with a multimeter, I can still see if something is working properly in my circuit using that.</p>
    <p>If you want to test this out with your board you can use this <a href="../files/week08/LED_and_SERVO.ino">Arduino Code</a></p>

</div>

  <div class="week-content text-center">
    <h1>Designing a PCB for DAP-R</h1>
    <p>This week we were tasked to design a PCB using one of the tools that we were described in class. Originally I wanted to use Eagle because of its integration with Fusion, however, my PC just refused to open Eagle no matter what I did. So I moved onto KiCAD! To be able to design any circuit you need to know what your inputs and outputs are and how to be able to control them. So I started by breaking down the components I needed for my board.</p>
    <ul>
      <li>Inputs</li>
      <ul>
        <li>Distance Sensor (make sure robot doesn't fall off of table)</li>
        <li>Camera Sensor (robot sees face - robot responds with emotes)</li>
      </ul>
      <li>Outputs</li>
      <ul>
        <li>Servos x2</li>
        <li>Motors x2</li>
        <li>Screen (for the robot to emote) </li>
      </ul>
    </ul>
    <p>With all of this I was able to break down how many pins and leads I would need for my circuit to work. But the first thing I noticed was that there was an easier board to use to incorporate cameras to my system:</p>
    <h3>The ESP32 SEEED Sense</h3>
    <img src="https://files.seeedstudio.com/wiki/SeeedStudio-XIAO-ESP32S3/img/2.jpg">
    <p>This board has the same exact footprint as the SEEED XIAO RP2040 except it has a different chip driving it. It also has a expansion board that adds two additional pins to work with as well as a camera.</p>
    <h2>Organizing the Board</h2>
    <p>Next I had to see if the pin outs would work for the idea that I had. Luckily they did! Or at least for a prototype. So I set my board up something like this:</p>
    <img src="../images/week08/BoardPlan.png">
    <p>So having this layout I need to set up a board on KiCAD. I had never used KiCAD before so I did what anyone would do, I looked up a YouTube Video to walk me through the process. Specifically the video below:</p>

    <!-- KiCAD Tutorial Video -->
    <iframe width="560" height="315" src="https://www.youtube.com/embed/l9b_6WLemmg" title="Quickstart Intro to Kicad - Design a board in 5 minutes" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
    <p>In short the video breaks up KiCAD into four stages:</p>
    <ol>
      <li>Set up Schematic</li>
      <li>Set up Footprints</li>
      <li>Board Check</li>
      <li>Connect leads on PCB</li>
    </ol>
    <p>I played around with KiCAD a bit making boards with my students but unfortunately I did not track that work. Then I got to work on my personal circuit board. But first I had to do some preliminary steps to make my job a little easier. Specifically setting up my KiCAD to have the libararies that contain all the parts we were told to purchase for the Academy.</p>
    <h2>Installing the Fab Academy Libraries</h2>
    <h3>Step One: Download the Libraries</h3>
    <p>The libraries of footprints and components are located <a href="https://gitlab.fabcloud.org/pub/libraries/electronics/kicad">here</a></p>
    <p>It will open up a GitLab page like below:</p>
    <img src="../images/week08/KiCADDL1.png">
    <p>You then click on the KiCAD library and go to the blue box that says "code" and download the .zip file there</p>
    <img src="../images/week08/KiCADDL3.png">
    <h3>Step Two: Install into KiCAD</h3>
    <p>This part is pretty simple you just install the files to two separate directories in KiCAD.</p>
    <h2>A quick tutorial on how to install the Fab Academy libraries:</h2>

    <!-- Fab Academy Library install Tutorial Video -->
    <iframe width="560" height="315" src="https://www.youtube.com/embed/r_l9aJPRUhQ " title="PP - Fab Academy - Week 08 - KiCAD Fab Academy Library Install Clip" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
    <h2>Finding my components</h2>
    <p>Once the fab libraries are installed in the KiCAD system you can pull on all of the components that we were told to purchase for our labs. This creates a great balance for two reasons. One, I can be sure I am using the same component with the same footprint as the one that I am purchasing. And the datasheets are the ones that match the ones in the system so I can use them to figure out what the pinouts and footprints are.</p>
    <p>To find these we can easily do this by following a few steps </p>
    <ul>
      <li>Click on add schematic to board</li>
      <li>In the search bar, type in "fab"</li>
      <li>If you are looking for a specific component make sure you type in the information for what you need, ex: SEEED</li>
      <ul>
        <li>Protip: SMD means surface mount, THT means through hole</li>
      </ul>
      <li>Finally click add symbol to schematic</li>
    </ul>
    <div class="week-content img-left">
      <img src="../images/week08/KiCADSchemUp (1).png">
      <img src="../images/week08/KiCADSchemUp (2).png">
    </div>
    <div class="week-content img-left">
      <img src="../images/week08/KiCADSchemUp (3).png">
      <img src="../images/week08/KiCADSchemUp (4).png">
    </div>
    <p>Once you do this, you add all the components you need to your board and it should look something like this:</p>
    <img src="../images/week08/KiCADSchem.png">


    <h2>Connecting the Components</h2>
    <p>After this the next step is to get all of your components together and connecting them to the right pins so that they may interact with each other properly. In my opinion, this is the hardest part because it will make a mess if you do not do it properly. The trick is, <strong>use labels!</strong> Labels create a tag that allows the circuit to link one location to the other in KiCAD</p>
    <p>But Peter, how do I do this?</p>
    <ul>
      <li>How to connect components in the schematic:</li>
      <ul>
        <li>Press "L" on your keyboard to open up the label menu</li>
        <li>Type in the name of the new label you are using</li>
        <li>Connect this to the pin that you will be using for that component</li>
        <li>Copy Paste the same label to the other component that will be connected to that point</li>
      </ul>
    </ul>
    <div class="week-content img-left">
      <img src="../images/week08/KiCADLabels (1).png">
      <img src="../images/week08/KiCADLabels (2).png">
    </div>
    <div class="week-content img-left">
      <img src="../images/week08/KiCADLabels (3).png">
      <img src="../images/week08/KiCADLabels (4).png">
    </div>
    <p>Here you can see this example using the labels SERVO1 and SERVO2</p>

    <h2>Finally making the actual schematic:</h2>
    <h3>Step One: Electronics Check</h3>
    <p>On the top of the KiCAD menu there is a little button that is like a checklist. This does the electronics rule check. It will make sure you have connected everything you need to. </p>
    <img src="../images/week08/KiCADRules.png">
    <p>If you have a few errors, the biggest error that I had was having parts of the board not connected to anything. To fix this you use the no connections flag.</p>
    <img src="../images/week08/KiCADFlag.png">
    <p>You can see this in pin 3 here:</p>
    <img src="../images/week08/KiCADFlag3.png">

    <h3>Importing Components</h3>
    <p>The next step is to click on the board editor button it will open up another blank window, but do not panic.</p>
    <img src="../images/week08/KiCADBoardEdit.png">
    <p>To bring in all of your component you click on the "Update PCB with changes made to schematic"  </p>
    <img src="../images/week08/KiCADImportSch.png">
    <p>The next step is to spread out all of the components how you want them arranged in the editor. Make you you place them where they need to go geographically on your board</p>

    <h3>Connecting traces</h3>
    <p>Afer you have completed the process of putting your boards out, you have to connect all the boards together. Luckily kiCAD helps by creating a "rats nest" of cables all connected to each other that lets you know which pin should be connected to what. YOu may have to do some tweaking here to help you have things match up and rotate a few components to be able to get everything on one layer for milling. If you are sending things out to a PCB house you can use two or more layers more easily!</p>

    <h3>Freerouting plugin</h3>
    <p>I got a headache doing the connections, so I did what any good maker does. Google to see if someone made our lives easier. And someone did. There is a plugin called freerouter that allows you to do this. It is simple to install and all you have to do is follow steps on the GitHub. </p>
     <p>Once you do this it opens up a new function in plugins and tools in KiCAD</p>
    <img src="../images/week08/KiCADFreeroute.png">
    <p>Clicking this button allows you to actually have this automatically have the system choose where to put the routes. You have to check on them to be sure that the system did not make something on incorrect layers but once that is done you can get a really pretty board like this:</p>
    <img src="../images/week08/KiCADDAPR2.png">

    <h2>A full tutorial I made:</h2>
    <iframe width="560" height="315" src="https://www.youtube.com/embed/v1e0eSchc7U " title="PP - Fab Academy - Week 08 - KiCAD Tutorial Video" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

    <h3>A few failed designs:</h3>
    <div class="week-content img-left">
      <img src="../images/week08/Fail1.jpg">
      <img src="../images/week08/Fail2.JPG">
    </div>
    <img src="../images/week08/Fail3.JPG">
    <div class="week-content img-left">
      <img src="../images/week08/Fail4.JPG">
      <img src="../images/week08/Fail5.JPG">
    </div>

    <div class="week-content text-center">
      <h3>The Files</h3>
      <ul>
        <li><a href="../files/week08/DAPRBoard v2.kicad_sch">Board Schematic</a></li>
        <li><a href="../files/week08/DAPRBoard v2.kicad_pcb">Board PCB File</a></li>
      </ul>
  </div>




</div>


    <footer>
      <p>Copyright 2024 Peter Perez; - Creative Commons Attribution Non Commercial </p>
      <p>Source code hosted at <a href="https://gitlab.fabcloud.org/academany/fabacademy/2024/labs/hopelab/students/peter-perez">fabcloud/fabacademy/2024/peter-perez</a></p>
    </footer>
  </body>
</html>
